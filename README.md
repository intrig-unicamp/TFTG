# TFTG: Time Fidelity Traffic Generation through P4/Tofino Programmable Hardware

Repository of paper NETWORK-24-00606 submitted for IEEE Network Magazine special issue of Deterministic, Reliable, Resilient and Programmable Networks for 6G.

## Overview

Overview da ferramenta, alguma figurinha


## Available features



## How to install

### Requirements

## How to use


## Available commands

### Setup commands

#### Add output port
Add the output port for the configurated traffic
Parameters: P_ID of output port (Tofino P-ID)

Usage:
```python
# addGenerationPort(P_ID) Adiciona a porta de geração de trafego
Gerador.addGenerationPort(68)

# Adiciona a porta de saida do equipamento
Gerador.addOutputPort(5, 160, "100G") #Physical Port, Port ID(D_P), Port bw
```


<!-- Isso é um comentário e não será exibido no GitHub 


fim do intervalo
#### ATS Case 3
#### FRER Case 4
#### PREOF Case 4
#### Reordering Case 5
Gerador.reodering(False)
Gerador.reoderingLayer(2) # 2 FREF (TSN), 3 PREOF (DETNET)
#### gPTP Case 6
Gerador.setSyncPort(5,160) #Physical Port, Port ID(D_P)
Gerador.setGptpParams(syncInt = 125, correctField = 0, rateRatio = 1) # intervalo de sincronização (ms), valor setado pro correctionField (ns), valor setado pro rateRatio 


Gerador.generate()

-->


### Generation commands

#### Add a packet flow
Add a new flow of packets to be generated. The optional parameters have default values and can be set later in the code

Mandatory parameters: 
 - Name of the flow (for later identification)

Optional parameters
 - MODE of generation (could be by histograms or using numerical parameters)
 - PCP, indicating the priority of the flow (0-7)
 - PktLen, with the packet size in bytes
 - Eth_src and  Eth_dest, indicating the MAC source and destination
 - IP_src and  IP_dest, indicating the IP source and destination
  
```python
Gerador.addFlow(name,mode="computed",PCP=0,PktLen=654,Eth_src="10.2.2.2",Eth_dest="10.2.2.3",IP_src="198.168.1.0",IP_dest="198.168.1.1")

Gerador.setMode(name,mode="histogram")
Gerador.setPCP(name,PCP=7)
Gerador.setPktLen(name,PktLen=64)
Gerador.setEth(name,Eth_src="10.2.2.2",Eth_dest="10.2.2.3")
Gerador.setIP(name,IP_src="198.168.1.0",IP_dest="198.168.1.1")

```

For flows generated by histograms, the file path is required

```python
Gerador.histogram(name,"histogram.xml")
```

For flows computed, the interval (ns) to generate the packets are required. Optional parameters can also be defined

```python
# distribution(name = "flow", sendInt, intStdDev = 0) 
Gerador.distribution(name, sendInt = 10000, intStdDev = 10)
```

### Gate Control Standards

By default, no standards are applied. The user must define between the available standards to start using it

```python
Gerador.setGateControl(mode="")
```

#### TAS

Each gate of each port that will apply the standard must define its parameters. Another function that can be used is to set if the guard bands of the standard will be calculated or assumed to be inside the values already sent.

Mandatory parameters: 
 - P_ID of output port (Tofino P-ID)
 - queue for where the packet is forwarded
 - Time_Open and Time_Closed, defining the time the gate will be oppened and closed respectvely
 - Time_Offset, indicating when the gate will start to be oppen

```python
Gerador.setGateControl(mode="TAS")
Gerador.setGclPriPort(160, 1, 100, 900, 0) #Port ID(D_P), PCP (0-7), Time Open (ns), Time Closed (ns), Offset (ns)
Gerador.setGB(True) # Se verdadeiro deve computar a guardband (pkt_size/throughput) para n mandar pacotes mesmo q com o gate aberto antes do 
```

#### ATS

### Replicating packets

### Reordering packets

### Time Synchronization

A special packet that TFTG can emit is synchronization packets from TSN, using the gPTP, where we can also change some parameters as needed.

Usage

```python
Gerador.setSyncPort(5,160) #Physical Port, Port ID(D_P)
Gerador.setGptpParams(syncInt = 125, correctField = 0, rateRatio = 1) # intervalo de sincronização (ms), valor setado pro correctionField (ns), valor setado pro rateRatio 
```


## Examples




## Team
